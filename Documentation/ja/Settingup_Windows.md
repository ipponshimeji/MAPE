[目次](Index.md)

---

# セットアップ（Windows版）

ここではWindows版のセットアップ方法について説明します。

* [システム要件](#システム要件)
* [プログラムの取得](#プログラムの取得)
* [初期設定・テスト](#初期設定・テスト)
* [実行](#実行)


## システム要件

想定している動作環境は以下の通りです。

| 対象 | 条件 |
|:-----|:-----|
| OS | Windows （下記.NET Frameworkが動作するバージョン）|
| .NET Framework | 4.5以降 |

作者が実際に動かしてみている環境は、
Windows 10 (x64) version 1607, .NET Framework 4.6.2です。


## プログラムの取得

ソースをビルドするか、
[リリース](../../Releases/README.ja.md)からバイナリを取得して、
適切な場所に解凍して利用してください。


## 初期設定・テスト

(version 1.0.11.0以降、初期設定方法はより簡単になりました)

GUI版の「認証プロキシ爆発しろ！」（`mapegui.exe`）を起動してください。
初回起動時に初期設定ウィンドウが表示されます。
初期設定ウィンドウの指示に従って設定を行ってください。

注意点について以下に説明します。

### 「認証プロキシ」ページ

認証プロキシのアドレスを自動的に検出できなかった場合は、
手動で設定する必要があります。

### 「システム設定書換」ページ

「認証プロキシ爆発しろ！」は通信を中継する際にプロキシ設定を書き換えます。
ほとんどの設定項目は自動的に適切な値に書き換えられますが、
以下の設定項目に関してはどのように書き換えればよいか自動的に判断できないため、
これらの値をあらかじめ教えておく必要があります。

* コントロールパネルの「インターネット オプション」-「接続」-「LANの設定」における、
    * 「ローカルアドレスにはプロキシサーバーを使用しない」
    * 「詳細設定」-「次で始まるアドレスにはプロキシを使用しない」

これらに相当する内容をここで設定してください。
なお、「次で始まるアドレスにはプロキシを使用しない」が空白でない場合（すでに設定されている場合）、
「認証プロキシ爆発しろ！」はその値を流用しますので、
ここでの設定は不要です。

プロキシを使用しないアドレスが分からない場合は、ネットワーク管理者に聞いてください。
なのですが、
一般に認証プロキシが導入されているような環境の場合、
社内ネットワークのドメイン名がそれに該当する場合が多いでしょう。

以下はある環境における「次で始まるアドレスにはプロキシを使用しない」の設定内容の例です。

```
*.example.com;*.example.local
```

### 「テスト」ページ

接続テストを行うと、
認証プロキシに対する認証情報の入力が求められます。
ここで認証情報を保存させておくと、
以降、認証プロキシへの認証を自動的に処理します。


## 実行

「認証プロキシ爆発しろ！」はGUI版とコマンド版があります。

### GUI版の場合

`mapegui.exe`を実行します。

タスクトレイにアイコンが表示されますので、
そのアイコンのコンテキストメニューから中継機能を開始・停止できます。
アプリケーションを終了させる場合は、
タスクトレイのコンテキストメニューから「認証プロキシ爆発しろ！の終了」を選択します。

### コマンド版の場合

コンソール（コマンドプロンプトまたはPowerShell）を開き、
`mape.exe`を実行します。

```
.\mape.exe
```

コマンドが実行されると直ちに中継機能が開始されます。
コンソールにはログが表示されます。
コマンドを終了するには、Ctrl+Cを押します。
